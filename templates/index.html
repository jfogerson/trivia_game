{% extends "base.html" %}

{% block content %}
<div class="intro">
    <h1>ðŸŽ¯ Game of Thrones Jeopardy</h1>
    <img src="{{ url_for('static', filename='battle2.png') }}" alt="Battle" style="max-width: 300px; height: auto; margin: 10px 0;">
    <p>Battle Your Friends and demonstrate your prowess in this exciting multiplayer trivia challenge!</p>
</div>

<div style="text-align: center;">
    <h2>Join a Game</h2>
    <form id="joinForm">
        <div style="margin: 20px 0;">
            <input type="text" id="gameId" placeholder="Game ID" required style="padding: 10px; margin: 5px; border: 1px solid #ccc; border-radius: 5px;">
        </div>
        <div style="margin: 20px 0;">
            <input type="password" id="gamePassword" placeholder="Game Password" required style="padding: 10px; margin: 5px; border: 1px solid #ccc; border-radius: 5px;">
        </div>
        <div style="margin: 20px 0;">
            <input type="text" id="playerName" placeholder="Your Name" required style="padding: 10px; margin: 5px; border: 1px solid #ccc; border-radius: 5px;">
        </div>
        <button type="submit" class="btn">Join Game</button>
    </form>
    
    <div style="margin: 40px 0;">
        <a href="/admin" class="btn" style="text-decoration: none;">Administrator Login</a>
    </div>
</div>

<script>
document.getElementById('joinForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const gameId = document.getElementById('gameId').value;
    const password = document.getElementById('gamePassword').value;
    const playerName = document.getElementById('playerName').value;
    
    if (gameId && password && playerName) {
        fetch('/api/join_game', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                game_id: gameId,
                password: password,
                player_name: playerName
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                window.location.href = data.redirect;
            } else {
                alert(data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
        });
    }
});
</script>
{% endblock %}